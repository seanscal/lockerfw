FROM debian:wheezy
WORKDIR /code/

RUN apt-get update &&  \
    apt-get install -qy python-dev python-pip git libffi-dev libssl-dev

ADD requirements.txt /code/
RUN pip install -r requirements.txt

RUN useradd -d /home/user -m -s /bin/bash user
RUN chown -R user:user /code/
USER user
RUN python firmware.py


FROM python:2-onbuild
WORKDIR /code/
ADD ./ /code/
RUN pip install -r requirements.txt
CMD python firmware.py